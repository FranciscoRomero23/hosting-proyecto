---
- hosts: 127.0.0.1
  connection: local
  tasks:
  - name: Crear directorio root
    file:
      path: /var/www/html/fjwordpress
      state: directory
      owner: www-data
      group: www-data
      mode: 0775
  - name: Copiar el index.html
    copy: >
      src=files/apache2/index_wordpress.html
      dest=/var/www/html/fjwordpress/index.html
  - name: Copiar el virtualhost
    copy: >
      src=files/apache2/wordpress.conf
      dest=/etc/apache2/sites-available/wordpress.conf
  - name: Deshabilitamos el virtualhost por defecto
    command: a2dissite 000-default.conf
  - name: Habilitamos el virtualhost nuevo
    command: a2ensite wordpress.conf
    notify:
      - restart apache

  handlers:
    - name: restart apache
      service: name=apache2 state=restarted
